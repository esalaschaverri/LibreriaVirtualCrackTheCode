<!DOCTYPE html>
<html lang="en">
<head>  
    <title>Puntos por compra</title>
    <link rel="stylesheet" type="text/css" href="CSS/puntos_por_compra.css"/>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Bebas+Neue&family=Roboto:ital,wght@0,300;0,400;0,500;0,700;1,300&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/31355f9613.js" crossorigin="anonymous"></script>
</head>

<body onload="cargarTabla()">
    <!-- Logo y Menu -->
    <div class="contenedor">
        <div class="logo-menu" >
            <a href="index.html"><img class="logo" src="img/logo.png"/></a>
        </div>

        <div class="menu-top">
            <a href="sobreNosotros.html">SOBRE NOSOTROS</a>
            <a href="display_libros.html">LIBROS</a>
            <a href="">SOCIOS COMERCIALES</a>
            <a href="formulario_cliente_frecuente.html">CLIENTE FRECUENTE</a>
            <a href="iniciar_sesion.html">INICIAR SESIÓN</a>
            <a href="preguntasFrecuentes.html">PREGUNTAS FRECUENTES</a>
            <a href="contacto.html">CONTACTO</a>
        </div>
    </div>

    <!-- PERFIL -->
    
    <div class="button">
        <a class="button2" href="perfil_admin.html"><i class="fa-solid fa-user"></i></a>
    </div>


    <!-- Puntos -->

    <div class="crear-cuenta">
        <h1 class="text-morado">PUNTOS POR COMPRA</h1>

        <div class="flex-completo text-morado">
          <center>
            <table>
            <table id="puntosAgregados" border="solid" class="tabla">
                <tr class="tabla texto-negro">
                    <th>ID</th>
                    <th>MONTO DE COMPRA</th>
                    <th>PUNTOS</th>
                    <th>EDITAR</th>
                  </tr>
            </table>
        </div>

        <div>
            <button onclick="muestra()" class="buttons-Form">AGREGAR NUEVO MONTO</button>
        </div>

    </div>


    <div id="nuevo-monto" class="oculto crear-cuenta">

        <div class="flex-completo text-morado">
            <h1>NUEVO MONTO</h1>
            <input class="inputs" id="monto" type="text" placeholder="MONTO DE COMPRA" ><br>
            <input class="inputs" id="puntos" type="text" placeholder="PUNTOS" ><br>

            <button onclick="insertarPunto()" class="button-crear buttons-Form">AGREGAR</button> <!-- Nuevo Código -->
        </div>

        <div>
            <!-- <button class="buttons-Form">AGREGAR</button> --> <!-- Nuevo Código -->
        </div>
    </div>


    <div id="editar-monto" class="oculto crear-cuenta">

        <div class="flex-completo text-morado">
            <h1>EDITAR MONTO</h1>
            <input class="inputs" id="_id" type="text" placeholder="ID" ><br>
            <input class="inputs" id="monto2" type="text" placeholder="MONTO DE COMPRA" ><br>
            <input class="inputs" id="puntos2" type="text" placeholder="PUNTOS" ><br>

            <button onclick="actualizarPunto()" class="button-crear">AGREGAR</button> <!-- Nuevo Código -->
        </div>

        <div>
            <!-- <button class="buttons-Form">AGREGAR</button> --> <!-- Nuevo Código -->
        </div>
    </div>

    <div class="crear-cuenta">
        <h1  class="text-morado">VALOR DE CADA PUNTO</h1>
        <div class="flex-completo text-morado">
            <center>
            <table id="valorPuntos" border="solid" class="tabla">
                <tr class="tabla texto-negro">
                    <th>PUNTOS</th>
                    <th>VALOR EN COLONES</th>
                    <th>EDITAR</th>
                </tr>
                </table>
                <div>
                    <button onclick="muestra()" class="buttons-Form">EDITAR PUNTOS</button>
                </div>
                </table>
            </center>
        </div>
    </div>

    <!-- Nuevo Código -->

    <div id="nuevo-punto" class="oculto crear-cuenta">

        <div class="flex-completo text-morado">
            <h1>NUEVO PUNTO</h1>
            <input class="inputs" id="puntos" type="text" placeholder="MONTO DE COMPRA" ><br>
            <input class="inputs" id="valor" type="text" placeholder="PUNTOS" ><br>

            <button onclick="insertarPunto1()" class="button-crear buttons-Form">AGREGAR</button> <!-- Nuevo Código -->
        </div>

        <div>
            <!-- <button class="buttons-Form">AGREGAR</button> --> <!-- Nuevo Código -->
        </div>
    </div>


    <div id="editar-monto" class="oculto crear-cuenta">

        <div class="flex-completo text-morado">
            <h1>EDITAR PUNTO</h1>
            <!-- <input class="inputs" id="_id" type="text" placeholder="ID" ><br> -->
            <input class="inputs" id="puntos2" type="text" placeholder="MONTO DE COMPRA" ><br>
            <input class="inputs" id="valor2" type="text" placeholder="PUNTOS" ><br>

            <button onclick="actualizarPunto1()" class="button-crear">AGREGAR</button> <!-- Nuevo Código -->
        </div>

        <div>
            <!-- <button class="buttons-Form">AGREGAR</button> --> <!-- Nuevo Código -->
        </div>
    </div>

    <div class="footer">
        <div class="social">
            <img class="logos-social" src="img/facebook.png"/> 
            <img class="logos-social"src="img/instagram.png"/> 
            <img class="logos-social" src="img/twitter.png"/> 
        </div>
        <h4>LIBRERIA@HOTMAIL.COM</h4>
        <h4>+506 7777-8888</h4>
        <p class="derechos">DERECHOS RESERVADOS</p>
    </div>

    <script>
        function muestra() {
              // Código ejecutado al hacer click sobre el botón
              var textoOculto = document.getElementById("nuevo-monto");
              textoOculto.classList.remove("oculto");
            }

        function muestra2() {
            // Código ejecutado al hacer click sobre el botón
              var textoOculto = document.getElementById("editar-monto");
              textoOculto.classList.remove("oculto");
            }

        // Nuevo Código - Primera Tabla //

        function cargarTabla() {
            fetch("http://localhost:5000/montos/")
                .then(
                    function (response) {
                        return response.json();
                    }
                )
                .then(
                    function (json) {
                        for (var cont = 0; json.length > cont; cont++) {
                            var linea = "<tr><th>"+json[cont]._id+"</th><td>"+json[cont].monto+"</td><th>"+json[cont].punto+"</th><td><button onclick='muestra2()'>EDITAR</button></td></tr>";
                            document.getElementById("puntosAgregados").insertAdjacentHTML("beforeend", linea);
                        }
                    }
                )
        }

            function insertarPunto() {
                var datos = {
                monto: document.getElementById("monto").value,
                puntos: document.getElementById("puntos").value
                }
                
                fetch("http://localhost:5000/montos/insertar", {
                method: 'POST',
                body: JSON.stringify(datos),
                headers: {'Content-Type': 'application/json'}
                })
                .then(
                    function(response){
                    return response.json();
                    }
                )
            }

            function actualizarPunto() {
            var datos = {
                monto: document.getElementById("nombre2").value,
                puntos: document.getElementById("codigo2").value,
            }

            fetch("http://localhost:5000/montos/actualizar", {
                method: 'POST',
                body: JSON.stringify(datos),
                headers: { 'Content-Type': 'application/json' }
            })
                .then(
                    function (response) {
                        return response.json();
                    }
                )
            }

        // Nuevo Código - Segunda Tabla //

        function cargarTabla() {
            fetch("http://localhost:5000/montos/")
                .then(
                    function (response) {
                        return response.json();
                    }
                )
                .then(
                    function (json) {
                        for (var cont = 0; json.length > cont; cont++) {
                            var linea = "<tr><th>"+json[cont].puntos+"</th><td>"+json[cont].monto+"</th><td><button onclick='muestra2()'>EDITAR</button></td></tr>";
                            document.getElementById("valorPuntos").insertAdjacentHTML("beforeend", linea);
                        }
                    }
                )
        }

        function insertarPunto1() {
                var datos = {
                monto: document.getElementById("puntos").value,
                puntos: document.getElementById("valor").value
                }
                
                fetch("http://localhost:5000/montos/insertar", {
                method: 'POST',
                body: JSON.stringify(datos),
                headers: {'Content-Type': 'application/json'}
                })
                .then(
                    function(response){
                    return response.json();
                    }
                )
            }

            function actualizarPunto1() {
            var datos = {
                monto: document.getElementById("puntos2").value,
                puntos: document.getElementById("valor2").value,
            }

            fetch("http://localhost:5000/montos/actualizar", {
                method: 'POST',
                body: JSON.stringify(datos),
                headers: { 'Content-Type': 'application/json' }
            })
                .then(
                    function (response) {
                        return response.json();
                    }
                )
            }

    </script>

</body>
</html>